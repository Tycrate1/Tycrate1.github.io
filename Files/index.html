<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Tycrate1 Studio</title> 
        <link rel="stylesheet" href="styles.css">
    </head>

    <body style="background: #8ccbf2">
        <div class="container">
            <div class="header">
                <div class="title">
                    <h1>
                        <li>
                            <img src="Tycrate1.png" height="56" width="504">
                        </li>
                        
                        <li>
                            Stuido
                        </li>
                    </h1>
                </div>

                <div class="tabs">
                    <button class="tablink" onclick="openPage('home')" id="defaultOpen"><img src="Home.png" height="28px" width="124px"></button>
                    <button class="tablink" onclick="openPage('games')"><img src="Games.png" height="28px" width="156px"></button>
                    <button class="tablink" onclick="openPage('videos')"><img src="Videos.png" height="28px" width="188px"></button>
                    <button class="tablink" onclick="openPage('about')"><img src="About.png" height="28px" width="156px"></button>
                </div>

            <div class="tabscontent">
                <div id="home" class="tabcontent">
                    <h3>homecontent</h3>
                </div>

                <div id="games" class="tabcontent">
                    <h3>gamescontent</h3>
                    <iframe id="ytplayer" type="text/html" width="960" height="600" src="Web"></iframe>

                    <style type="text/css">
                        body {
                            margin : 0;
                        }

                        #autojumpbutton {
                            position : absolute;
                            left : 20px;
                            top : 20px;
                        }
                    </style>
                    <button id = "autojumpbutton" onclick = "toggleAutoJump()"><h2>AutoJump : On</h2></button>

                    <script src = "three.js"></script>
                    <script src = "perlin.js"></script>
                    <script src = "PointerLockControls.js"></script>
                    <script type="text/javascript">
                        noise.seed(Math.random());
                        var scene = new THREE.Scene();
                        var renderer = new THREE.WebGLRenderer();
                        renderer.setSize(window.innerWidth, window.innerHeight);
                        document.body.appendChild(renderer.domElement);
                        var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                        
                        var autoJump = true;
                        function toggleAutoJump() {
                            if(autoJump == true) {
                                autoJump = false;
                                document.getElementById("autojumpbutton").innerHTML = "<h2>AutoJump : Off</h2>";
                            } else {
                                autoJump = true;
                                document.getElementById("autojumpbutton").innerHTML = "<h2>AutoJump : On</h2>";
                            }
                        }

                        function Block(x, y, z) {
                            this.x = x;
                            this.y = y;
                            this.z = z;

                            this.display = function() {
                                var blockBox = new THREE.BoxBufferGeometry(5, 5, 5); // Width hight and depth
                                var blockMesh = new THREE.MeshBasicMaterial({color : 0x00ff00});
                                var block = new THREE.Mesh(blockBox, blockMesh);
                                scene.add(block);
                                block.position.x = this.x;
                                block.position.y = this.y - 10;
                                block.position.z = this.z;

                                var edges = new THREE.EdgesGeometry(blockBox);
                                var line = new THREE.LineSegments(edges, new THREE.LineBasicMaterial({color : 0x000000}));
                                scene.add(line);
                                line.position.x = this.x;
                                line.position.y = this.y - 10;
                                line.position.z = this.z;
                            }
                        }

                        var blocks = [];
                        var xoff = 0;
                        var zoff = 0;
                        var inc = 0.05;
                        var amplitude = 50;
                        for(var x = 0; x < 20; x++){
                            xoff = 0;
                            for(var z = 0; z < 20; z++){
                                var v = Math.round(noise.perlin2(xoff, zoff) * amplitude / 5) * 5;
                                blocks.push(new Block(x * 5, v, z * 5));
                                xoff = xoff + inc;
                            }
                            zoff = zoff + inc;
                        }

                        for(var i = 0; i < blocks.length; i++) {
                            blocks[i].display();
                        }

                        var keys = [];
                        var canJump = true;
                        document.addEventListener("keydown", function(e) {
                            keys.push(e.key);
                            if(e.key == " " && canJump == true) {
                                ySpeed = -1.3;
                                canJump = false;
                            }
                        });

                        document.addEventListener("keyup", function(e) {
                            var newArr = [];
                            for(var i = 0; i < keys.length; i++) {
                                if(keys[i] != e.key) {
                                    newArr.push(keys[i]);
                                }
                            }
                            keys = newArr;
                        });

                        var controls = new THREE.PointerLockControls(camera, document.body);
                        document.body.addEventListener("click", function() {
                            controls.lock();
                        });
                        controls.addEventListener("lock", function() {

                        });
                        controls.addEventListener("unlock", function() {

                        });

                        var movingSpeed = 0.7;
                        var ySpeed = 0;
                        var acc = 0.08;
                        function update() {
                            if(keys.includes("w")) {
                                controls.moveForward(movingSpeed);
                                if(autoJump == false){
                                    for(var i = 0; i < blocks.length; i++){
                                        if(camera.position.x <= blocks[i].x + 2.5 && camera.position.x >= blocks[i].x - 2.5 && camera.position.z <= blocks[i].z + 2.5 && camera.position.z >= blocks[i].z - 2.5){
                                            if(camera.position.y == blocks[i].y - 2.5){
                                                controls.moveForward(-1 * movingSpeed);
                                            }
                                        }
                                    }
                                }
                            }
                            if(keys.includes("a")) {
                                controls.moveRight(-1 * movingSpeed);
                                if(autoJump == false){
                                    for(var i = 0; i < blocks.length; i++){
                                        if(camera.position.x <= blocks[i].x + 2.5 && camera.position.x >= blocks[i].x - 2.5 && camera.position.z <= blocks[i].z + 2.5 && camera.position.z >= blocks[i].z - 2.5){
                                            if(camera.position.y == blocks[i].y - 2.5){
                                                controls.moveRight(movingSpeed);
                                            }
                                        }
                                    }
                                }
                            }
                            if(keys.includes("s")) {
                                controls.moveForward(-1 * movingSpeed);
                                if(autoJump == false){
                                    for(var i = 0; i < blocks.length; i++){
                                        if(camera.position.x <= blocks[i].x + 2.5 && camera.position.x >= blocks[i].x - 2.5 && camera.position.z <= blocks[i].z + 2.5 && camera.position.z >= blocks[i].z - 2.5){
                                            if(camera.position.y == blocks[i].y - 2.5){
                                                controls.moveForward(movingSpeed);
                                            }
                                        }
                                    }
                                }
                            }
                            if(keys.includes("d")) {
                                controls.moveRight(movingSpeed);
                                if(autoJump == false){
                                    for(var i = 0; i < blocks.length; i++){
                                        if(camera.position.x <= blocks[i].x + 2.5 && camera.position.x >= blocks[i].x - 2.5 && camera.position.z <= blocks[i].z + 2.5 && camera.position.z >= blocks[i].z - 2.5){
                                            if(camera.position.y == blocks[i].y - 2.5){
                                                controls.moveRight(-1 * movingSpeed);
                                            }
                                        }
                                    }
                                }
                            }

                            camera.position.y = camera.position.y - ySpeed;
                            ySpeed = ySpeed + acc;

                            for(var i = 0; i < blocks.length; i++) {
                                if(camera.position.x <= blocks[i].x + 2.5 && camera.position.x >= blocks[i].x - 2.5 && camera.position.z <= blocks[i].z + 2.5 && camera.position.z >= blocks[i].z - 2.5) {
                                    if(camera.position.y <= blocks[i].y + 2.5 && camera.position.y >= blocks[i].y - 2.5) {
                                        camera.position.y = blocks[i].y + 2.5;
                                        ySpeed = 0;
                                        canJump = true;
                                        break;
                                    }
                                }
                            }
                        }

                        //Resize Window
                        window.addEventListener("resize", function(){
                            renderer.setSize(window.innerWidth, window.innerHeight);
                            camera.aspect = window.innerWidth / window.innerHeight;
                            camera.updateProjectionMatrix();
                        });

                        function render() {
                            renderer.render(scene, camera);
                        }

                        function GameLoop() {
                            requestAnimationFrame(GameLoop);
                            update();
                            render();
                        }

                        GameLoop();
                    </script>
                </div>

                <div id="videos" class="tabcontent">
                    <h3>videoscontent</h3>
                    <iframe id="ytplayer" type="text/html" width="640" height="360" src="https://www.youtube.com/embed/fS224GeK_TY?autoplay=1&origin=http:/https://www.youtube.com/watch?v=fS224GeK_TY" frameborder="0"></iframe>
                </div>

                <div id="about" class="tabcontent">
                    <h3>aboutcontent</h3>
                </div>
            </div>
        </div>
    </body>

    <script>
        function openPage(pageName) {
            var i, tabcontent;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
            }

            document.getElementById(pageName).style.display = "block";
        }

        document.getElementById("defaultOpen").click();
    </script>
</html>